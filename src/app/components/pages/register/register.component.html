<app-header></app-header>
<div class="container">
    <div class="inner-container">
        <h3>Inscription</h3>
        
        
        <form class="register-form-style" [formGroup]="registerForm"  (ngSubmit)="submit()">
            <div class="client-register">
                <div class="file-upload">
                    <ngx-avatars *ngIf="imageIsUploaded" size="100" [src]="image"></ngx-avatars>
                    {{ fileName || "Photo de profil"}}
                    <button class="upload-btn" (click)="pdpUpload.click()" type="button"><mat-icon >attach_file</mat-icon></button>
                </div>
                <div class="row">
                    <app-radio-input
                    [control]="fc.userType"
                    [showErrorsWhen]="isSubmitted"
                    ></app-radio-input>
                </div>
                <input type="file" class="file-input" (change)="onFileImageSelected($event)" #pdpUpload>
                <input type="file" class="file-input" (change)="onFileDocumentSelected($event)" #documentUpload>
                
                <div class="row">
                    <text-input
                        [control]="fc.userName"
                        [showErrorsWhen]="isSubmitted"
                        label="Nom">
                    </text-input>
                    <text-input
                        [control]="fc.userFirstname"
                        [showErrorsWhen]="isSubmitted"
                        label="Prénom">
                    </text-input>
                    
                </div>        
                
                <div class="row">
                    <text-input
                        [control]="fc.userEmail"
                        [showErrorsWhen]="isSubmitted"
                        label="Email"
                        [type]="'email'">
                    </text-input>
                    
                    <!-- <text-input
                        [control]="fc.userPhone"
                        [showErrorsWhen]="isSubmitted"
                        label="Téléphone">
                    </text-input> -->
                    <mat-form-field appearance="outline">
                        <ngx-intl-tel-input
                        formControlName="userPhone"
                        name ="userPhone"
                        [separateDialCode]="true"
                        [cssClass]="'custom'"
                        [preferredCountries]="['mg']"
                        [enablePlaceholder]="true"
                        [searchCountryFlag]="true"
                        [selectFirstCountry]="true"
                        [maxLength]="15"
                        [phoneValidation]="true"
                        #phone>
                        <input matInput [formControl]="userPhone">
                    </ngx-intl-tel-input>              
                </mat-form-field>
                    
                </div> 
                <div class="row">
                    <app-password-input
                        [control]="fc.userPassword"
                        [showErrorsWhen]="isSubmitted"
                        label="Mot de passe">
                    </app-password-input>
                    <app-password-input
                        [control]="fc.confirmPassword"
                        [showErrorsWhen]="isSubmitted"
                        label="Confirmation mot de passe">
                    </app-password-input>
                </div>
                <!-- <text-input
                [control]="fc.refId"
                [showErrorsWhen]="isSubmitted"
                label="Referral">
                </text-input>        -->
                <div class="row">
                    <mat-form-field appearance="outline" >
                        <mat-label>Date de naissance</mat-label>
                        <input matInput #dateInput [matDatepicker]="picker" [formControl]="dateOfBirth" (onfocus)="dateInput.type ='date'" (blur)="dateInput.type ='text'"> 
                        <!-- <mat-hint>{{dateFormatString()}}</mat-hint> -->
                        <mat-datepicker-toggle [for]="picker" style="position: absolute;margin-top:-8px;margin-left: -10px;"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                        <!-- <mat-hint>MM/DD/YYYY</mat-hint> -->
                    </mat-form-field>
                    <text-input
                        [control]="fc.userAddress"
                        [showErrorsWhen]="isSubmitted"
                        label="Adresse">
                    </text-input>
                </div>
                <div class="row">
                    <div class="options">
                    <mat-form-field appearance="outline">
                        <mat-label>Document d'identification</mat-label>
                        <mat-select matNativeControl [(value)]="documentType" >
                            <mat-option value="cin" selected>CIN</mat-option>
                            <mat-option value="passeport">Passeport</mat-option>
                            <mat-option value="permis">Permis de conduire</mat-option>
                        </mat-select>
                    </mat-form-field>
                    
                </div>
                    <text-input
                        [control]="fc.identityCardNumber"
                        [showErrorsWhen]="isSubmitted"
                        label="Numéro du Document">
                    </text-input>
                </div>
                <div class="file-upload">
                    <div class="idDocumentUpload" *ngIf="documentType">
                        <p *ngIf="documentType && !identityDocument"> Photo de votre : </p>
                        <img height="100px" *ngIf="identityDocument" [src]="identityDocument" alt="">
                        {{ identityDocumentName || documentType | uppercase}}
                        <button class="upload-btn" (click)="documentUpload.click()" type="button"><mat-icon >attach_file</mat-icon></button>
                    </div>
                </div>    
            
        </div>
        
        <div class="rightSide">
            
            <div class="row">
            <input-container>
                <mat-form-field appearance="outline">
                    <mat-label>Latitude</mat-label>
                    <input matInput type="text" [(ngModel)]="latitude" [ngModelOptions]="{standalone:true}">
                </mat-form-field>
            </input-container>
            <input-container>
                <mat-form-field appearance="outline">
                    <mat-label>Longitude</mat-label>
                    <input matInput type="text" [(ngModel)]="longitude" [ngModelOptions]="{standalone:true}">
                </mat-form-field>
            </input-container>
        </div>
            <google-map height="50vh"
                width="50vh"
                [center]="center"
                [zoom]="6"
                (mapClick)="moveMap($event)"
                >
                <!-- (mapMousemove)="move($event)"  -->
                <!-- *ngFor="let position of markerLatLong" -->
            <map-marker 
            [position]="position"></map-marker>
        </google-map>
        </div>
        
            <div class="buttonContainer">
                <!-- <app-default-button text="S'INSCRIRE" type="submit" (onClick)="sendEmail($event)"></app-default-button> -->
                <!-- <app-default-button text="SE CONNECTER" routerLink="/login" type="button"></app-default-button> -->
                 <div>
                    <!-- <app-default-button text="S'inscrire" type="submit" [disabled]="!registerForm.valid" ></app-default-button> -->
                     <app-default-button text="S'inscrire" type="submit"></app-default-button>
                 </div>
                 <a routerLink="/login"><p style="text-align: center;">J'ai déjà un compte</p></a>
            </div>
        </form>
        
        
    </div>
</div>